<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGI Docs | Manual T칠cnico</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Mermaid JS -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>

<body>
    <nav class="navbar">
        <div class="container nav-content">
            <a href="index.html" class="nav-logo">
                <img src="assets/images/logo.png" alt="SGI Logo"
                    style="height: 40px; vertical-align: middle; margin-right: 10px;">
                SGI Docs
            </a>
            <div class="nav-links">
                <a href="tecnico.html" class="nav-link active">T칠cnico</a>
                <a href="campo.html" class="nav-link">Campo</a>
                <a href="admin.html" class="nav-link">Admin</a>
                <button id="themeToggle" class="theme-toggle">游깿</button>
            </div>
        </div>
    </nav>

    <header class="hero" style="padding: 80px 0 40px;">
        <div class="container">
            <h1>Manual T칠cnico</h1>
            <p>Arquitectura del Sistema, Flujos de Datos y Documentaci칩n del C칩digo</p>
        </div>
    </header>

    <main class="container manual-section">

        <!-- SECCI칍N 1: ROUTER -->
        <section class="card mb-4 reveal">
            <h2>1. Router Din치mico (Data-Driven)</h2>
            <p>El n칰cleo del sistema es un router inteligente que decide qu칠 funci칩n ejecutar bas치ndose en la
                configuraci칩n de la hoja de c치lculo <code>Directorio_Regional</code>. Esto permite agregar nuevas
                regiones o flujos sin modificar el c칩digo.</p>

            <div class="mermaid">
                graph TD
                A[Formulario Google] -->|Trigger| B(onAccessFormSubmit)
                B --> C{Obtener Sucursal}
                C --> D[Consultar DB_Sucursales]
                D --> E{쮼xiste Sucursal?}
                E -- NO --> F[Error / Log]
                E -- SI --> G[Obtener Regi칩n]
                G --> H[Consultar Directorio_Regional]
                H --> I[Obtener Funci칩n Columna I]
                I --> J{Ejecutar Din치micamente}
                J --> K[ejecutarFlujoEstandarV33]
                J --> L[ejecutarFlujoMetro]
            </div>

            <h3>Funci칩n Principal: <code>onAccessFormSubmit(e)</code></h3>
            <pre><code>function onAccessFormSubmit(e) {
  // 1. Obtiene la Sucursal del evento
  // 2. Busca la regi칩n en DB_Sucursales
  // 3. Busca el nombre de la funci칩n en Directorio_Regional
  // 4. Ejecuta this[nombreFuncion](e)
}</code></pre>
        </section>

        <!-- SECCI칍N 2: ACCESOS V33 -->
        <section class="card mb-4 reveal">
            <h2>2. M칩dulo de Accesos (V33)</h2>
            <p>Gestiona la generaci칩n de cartas de acceso en PDF, notificaciones por correo y alertas en Telegram con
                geolocalizaci칩n.</p>
            <ul>
                <li><strong>Entrada:</strong> Formulario de Google (Respuestas_Accesos).</li>
                <li><strong>Proceso:</strong> Cruce de datos con <code>DB_Sucursales</code> (Tickets, SIRH, Building
                    ID).</li>
                <li><strong>Salida:</strong> PDF generado desde template, Email a L칤deres, Telegram al Grupo Regional.
                </li>
            </ul>
        </section>

        <!-- SECCI칍N 3: COTIZADOR IA -->
        <section class="card mb-4 reveal">
            <h2>3. Motor de Cotizaciones IA (Ingenier칤a de Costos)</h2>
            <p>Sistema avanzado que utiliza Agentes LLM (OpenAI) y B칰squeda Vectorial para estimar costos de
                mantenimiento.</p>

            <div class="mermaid">
                sequenceDiagram
                participant User as Formulario
                participant Main as Script Cotizador
                participant AgtA as Agente A (Procesos)
                participant AgtB as Agente B (Cuantificador)
                participant VecDB as Vector DB (Embeddings)
                participant AgtC as Agente C (Precios)

                User->>Main: Env칤a Hallazgo + Fotos
                Main->>AgtA: 쯈u칠 actividades se requieren?
                AgtA->>Main: Plan de Trabajo (Preliminares, Ejecuci칩n)
                Main->>AgtB: 쮺u치nta cantidad? (Deducci칩n)
                AgtB->>Main: Lista Cuantificada
                loop Validar Item
                Main->>VecDB: Buscar Items Similares (Embeddings)
                VecDB->>Main: Candidatos Cat치logo
                Main->>AgtC: Seleccionar Mejor Opci칩n o Estimar
                AgtC->>Main: Precio Unitario / Clave
                end
                Main->>User: Genera PDF Cotizaci칩n
            </div>

            <h3>Agentes Definidos</h3>
            <table style="width:100%; border-collapse: collapse; margin-top: 1rem;">
                <tr style="background: rgba(0,0,0,0.05);">
                    <th style="padding:10px; border:1px solid #ccc;">Agente</th>
                    <th style="padding:10px; border:1px solid #ccc;">Rol</th>
                    <th style="padding:10px; border:1px solid #ccc;">Funci칩n</th>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;"><strong>Agente A</strong></td>
                    <td style="padding:10px; border:1px solid #ccc;">Ingeniero de Procesos</td>
                    <td style="padding:10px; border:1px solid #ccc;">Desglosa el hallazgo en pasos l칩gicos (Preliminar
                        -> Ejecuci칩n -> Cierre).</td>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;"><strong>Agente B</strong></td>
                    <td style="padding:10px; border:1px solid #ccc;">Generador de N칰meros</td>
                    <td style="padding:10px; border:1px solid #ccc;">Calcula cantidades bas치ndose en "Cantidades
                        Maestras" detectadas en el texto.</td>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;"><strong>Agente C</strong></td>
                    <td style="padding:10px; border:1px solid #ccc;">Analista de Precios</td>
                    <td style="padding:10px; border:1px solid #ccc;">Realiza el "Matching" con el cat치logo oficial o
                        estima precios de mercado.</td>
                </tr>
            </table>
        </section>

        <!-- SECCI칍N 4: TELEGRAM -->
        <section class="card mb-4">
            <h2>4. Integraci칩n Telegram</h2>
            <p>El bot utiliza la API de Telegram para enviar reportes ricos en formato.</p>
            <pre><code>function enviarNotificacionTelegram(token, chatId, mensaje, pdfBlob, lat, lon) {
  // 1. Env칤a PDF con Caption (Resumen)
  // 2. Env칤a Ubicaci칩n (SendLocation)
  // 3. Env칤a desglose de Tickets (Mensajes individuales)
}</code></pre>
        </section>

    </main>

    <footer class="container text-center mb-4">
        <p style="opacity: 0.6; font-size: 0.9rem;">&copy; 2025 Mantenimiento Sinai.</p>
        <p style="font-size: 0.85rem; margin-top: 5px;">
            <a href="https://www.linkedin.com/company/mantenimiento-sinai/" target="_blank"
                style="color: var(--color-primary); text-decoration: none; margin-right: 15px;">
                LinkedIn: Mantenimiento Sinai
            </a>
            <a href="mailto:ventas@sinaimx.com" style="color: var(--color-primary); text-decoration: none;">
                Email: ventas@sinaimx.com
            </a>
        </p>
    </footer>

    <script src="js/main.js"></script>
</body>

</html>
<script src='js/search.js'></script>